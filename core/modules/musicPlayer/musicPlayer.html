<script>
	window.Yolk.getModule();	
</script>

<div ng-controller="musicPlayer" id='playframe'>	
	<div id='topmen' ng-style="{height:dims.menHeight}">
			<span ng-click="sort('title')">Title </span>
			<span ng-click="sort('artist')">Artist </span>
			<span ng-click="sort('album')">Album </span>	
	</div>
	<div id='search' ng-show='dbReady && settings.paths.musicDir' ng-style="{height:dims.searchHeight,width:dims.playwindowWidth}">
		<input ng-model="searchTerm" type='text' />
		<div id='mask' ng-if='!sources.length'></div>
	</div>
	<div id='playwindow' ng-style="{width:dims.playwindowWidth, height:dims.playwindowHeight}">
		<div id = 'loading' class='ani-fOut' ng-if="!dbReady || !settings.paths.musicDir">
			<div class='throbber'></div>
			<div ng-if='!dbReady'>Connecting</div>
			<div ng-if='dbReady && !settings.paths.musicDir' ng-click='fileSelect()'>Select your music folder</div>
		</div>

		<div id='tracks' ng-show='dbReady && settings.paths.musicDir' ng-style="{paddingTop:lazy.paddingTop,paddingBottom:lazy.paddingBottom}">

			<div ng-if="lib.playing.spacer" ng-style="{height:lazy.trackHeight+lazy.progressHeight,width:'100%'}"></div>
			<div ng-repeat="track in lib.tracks track by track.id" class='ani-fIn'>
				<div class='track' 
					ng-class="track.state"
					ng-class="track.filter.zebra"  
					ng-style="{ 
						height: track.state ? lazy.playingHeight : lazy.trackHeight 
					} ">
					<div class='inner' ng-if="!track.state">
						<div class='above'>
							<div class='icons' ng-click="audio.play(track)">
								<div class='play icon icon-play'></div>
							</div>
							<div class='title'>{{track.filter.pos}} {{::track.metadata.title || track.file}}</div>							
						</div>	
						<div class='below'>	
							<div class='icons'>
								
							</div>
							<div class='info'>				
								<div class='artist row' ng-if="track.metadata.artist" ng-click="pin.pin('artist',track.metadata.artist)" ng-class="{'pinned':pinned.artist === track.metadata.artist}">
									<span class='cancel icon-cancel'></span>
									{{::track.metadata.artist}}
								</div>
								<div class='row' ng-if='!track.metadata.artist'>
									[Artist unknown]
								</div>	
								<div class='album row' ng-if="track.metadata.album"  ng-click="pin.pin('album',track.metadata.album)" ng-class="{'pinned':pinned.album === track.metadata.album}">
									<span class='cancel icon-cancel'></span>
									{{::track.metadata.album}}
								</div>
								<div class='row' ng-if='!track.metadata.album'>
									[Album unknown]
								</div>
							</div>
						</div>			
					
					</div>
					<div class='bottom'></div>
				</div>
				
			</div>
			<div id='playing' class='track ani-fIn'
				ng-if = "lib.playing"
				ng-style="{
					height:lazy.trackHeight+lazy.progressHeight,
					top:lib.playing.top,
					
				}" 
				ng-class="{
					playing:lib.playing.state === 'playing',
					paused:lib.playing.state === 'paused',
				}"
			>
				<div class='inner' 
					ng-style="{
						width:dims.playwindowWidth - dims.scroller
					}"
				>
					
					<div class='above'>
						<div class='icons' ng-click="audio.play(lib.playing)">
							<div ng-show="lib.playing.state==='paused'" class='play icon icon-play'></div>
							<div ng-show="lib.playing.state==='playing'" class='pause icon icon-pause'></div>
						</div>
						<div class='title'>{{lib.playing.filter.pos}} {{lib.playing.metadata.title || lib.playing.file}}</div>
						<div class='next' ng-if="lib.playing.Pinned">
							<div class="icon icon-previous"></div>
							<div class='nextTrack' ng-click="audio.play(lib.playing.index+1)">{{lib.tracks[lib.playing.index+1].metadata.title ||lib.tracks[0].metadata.title }}</div>
							<div class="icon icon-next"></div>
						</div>
					
						<div class='scroll up icon-up' 
							ng-click="lazy.Scroll('up')"  
							ng-if="lib.playing.Bottom && !lib.playing.spacer"
						></div>
					</div>
					<div class='progressBar' ng-click="audio.seek($event)" ng-style="{height:lazy.progressHeight}">
						<div class='progress' 							
							ng-class="{noAni:!lib.playing.ani}"
						></div>
					</div>	
					<div class='below'>	
						<div class='icons'>
						
						</div>
						<div class='info'>				
							<div class='artist row' ng-click="pin.pin('artist',lib.playing.metadata.artist)" ng-class="{'pinned':pinned.artist === lib.playing.metadata.artist}">
								<span class='cancel icon-cancel'></span>
								{{lib.playing.metadata.artist || '[Unknown]'}}
							</div>	
							<div class='album row' ng-click="pin.pin('album',lib.playing.metadata.album)" ng-class="{'pinned':pinned.album === lib.playing.metadata.album}">
								<span class='cancel icon-cancel'></span>
								{{lib.playing.metadata.album || '[Unknown]'}}
							</div>
						</div>
						<div class='scroll down icon-down' 
							ng-click="lazy.Scroll('down')" 
							ng-if="lib.playing.Top && !lib.playing.spacer">
						</div>
					</div>
			
				</div>
			</div>
		</div>
	</div>
	<div id='sidebar' ng-style="{width:dims.sidebarWidth, height:dims.sidebarHeight, top:dims.menHeight}">
		<div class='anchor' 
			ng-style="{width:dims.sidebarWidth - 10, margin:'5px'}"
			ng-click="pin.pin('source','local')"
			ng-class = "{
				active:pinned.sources.indexOf('local') > -1,
				dead:pinned.sources.length === 1 && pinned.sources[0]!=='suggestions'
			}"
		>
			<span class='cancel icon-cancel'></span>
			Local
		</div>
		<div class='anchor' 
			ng-style="{width:dims.sidebarWidth - 10, margin:'5px'}"
			ng-click="pin.pin('source','online')"
			ng-class = "{
				active:pinned.sources.indexOf('online') > -1,
				dead:pinned.sources.length === 1 && pinned.sources[0]!=='suggestions'
			}"
		>
			<span class='cancel icon-cancel'></span>
			Online
		</div>
		<div class='anchor' 
			ng-style="{width:dims.sidebarWidth - 10, margin:'5px'}"
			ng-click="pin.pin('source','torrents')"
			ng-class = "{
				active:pinned.sources.indexOf('torrents') > -1,
				dead:pinned.sources.length === 1 && pinned.sources[0]!=='suggestions'
			}"
		>
			<span class='cancel icon-cancel'></span>
			Torrents
		</div>
		<div class='anchor' 
			ng-style="{width:dims.sidebarWidth - 10, margin:'5px'}"
			ng-click="pin.pin('source','suggestions')"
			ng-class = "{active:pinned.sources.indexOf('suggestions') > -1}"
		>
			<span class='cancel icon-cancel'></span>
			Suggestions
		</div>
		<div ng-click='db.nuke()'>NUKE!</div>
		<div><a href='#/'>Home</a></div>
		<div id = 'activity'>
			<div ng-if="progress.internetarchive">Internetarchive:{{progress.internetarchive}}</div>
			<div ng-if="progress.musicbrainz">Musicbrainz:{{progress.musicbrainz}}</div>
		</div>
	</div>
</div>
